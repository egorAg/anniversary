import { AnimatePresence, motion } from "framer-motion";
import React, { useEffect, useRef, useState } from "react";

function QuestStep() {
  const [isIntroSlide, setIsIntroSlide] = useState(true); // –î–ª—è –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ —Å–ª–∞–π–¥–∞
  const [currentTaskIndex, setCurrentTaskIndex] = useState(0);
  const [inputValue, setInputValue] = useState("");
  const [showInput, setShowInput] = useState(false); // –£–ø—Ä–∞–≤–ª—è–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –ø–æ–ª—è –≤–≤–æ–¥–∞
  const [isError, setIsError] = useState(false); // –£–ø—Ä–∞–≤–ª—è–µ—Ç —Ç—Ä—è—Å–∫–æ–π –∫–Ω–æ–ø–∫–∏
  const [isFinalSlide, setIsFinalSlide] = useState(false); // –î–ª—è —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ —ç–∫—Ä–∞–Ω–∞
  const [secretMessage, setSecretMessage] = useState(""); // –î–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–µ–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
  const inputRef = useRef(null); // –î–ª—è —Ñ–æ–∫—É—Å–∞ –Ω–∞ –ø–æ–ª–µ –≤–≤–æ–¥–∞

  const tasks = [
  {
    "title": "–ó–∞–≤—Ç—Ä–∞–∫ —Å —Å—é—Ä–ø—Ä–∏–∑–æ–º",
    "description": "–°–µ–≥–æ–¥–Ω—è —É—Ç—Ä–æ–º —Ç–µ–±—è –∂–¥—ë—Ç –≤–∫—É—Å–Ω–æ–µ –Ω–∞—á–∞–ª–æ –¥–Ω—è. ü•ê –î–æ—Å—Ç–∞–≤–∫–∞ –∏–∑ —Å–µ—Ä–≤–∏—Å–∞ ¬´–°–∞–º–æ–∫–∞—Ç¬ª –ø—Ä–∏–±—É–¥–µ—Ç –∫ —Ç–≤–æ–µ–π –¥–≤–µ—Ä–∏ —Å —Å—é—Ä–ø—Ä–∏–∑–æ–º. üéÅ –¢–≤–æ—è –∑–∞–¥–∞—á–∞ ‚Äî –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ –æ—Å–º–æ—Ç—Ä–µ—Ç—å –¥–æ—Å—Ç–∞–≤–∫—É. –í –æ–¥–Ω–æ–º –∏–∑ –ø–∞–∫–µ—Ç–æ–≤ —Ç–µ–±—è –∂–¥—ë—Ç –Ω–µ —Ç–æ–ª—å–∫–æ –∑–∞–≤—Ç—Ä–∞–∫, –Ω–æ –∏ –ø–æ–¥–∞—Ä–æ–∫. üéâ –ù–∞–π–¥–∏ –≤–Ω—É—Ç—Ä–∏ –∫–∞—Ä—Ç–æ—á–∫—É —Å –∫–ª—é—á–æ–º, —á—Ç–æ–±—ã –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Å–≤–æ–π –ø—É—Ç—å!",
    "key": "–°–ª–∞–¥–∫–∏–π —Å—Ç–∞—Ä—Ç",
    "secretMessage": "–î–∞–∂–µ –ø—Ä–æ—Å—Ç—ã–µ –º–æ–º–µ–Ω—Ç—ã —Ä—è–¥–æ–º —Å —Ç–æ–±–æ–π —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –æ—Å–æ–±–µ–Ω–Ω—ã–º–∏. –î–æ–±—Ä–æ–µ —É—Ç—Ä–æ, –ª—é–±–æ–≤—å –º–æ—è! ‚òÄÔ∏èüíõ"
  },
  {
    "title": "–°–µ–∫—Ä–µ—Ç–Ω—ã–π —Å–≤–µ—Ç",
    "description": "–°–ª–µ–¥—É—é—â–∞—è —Ç–æ—á–∫–∞ ‚Äî –º–∞–≥–∞–∑–∏–Ω –ø–æ–¥–∞—Ä–∫–æ–≤. üéÅ –í–Ω—É—Ç—Ä–∏ —Å–ø—Ä—è—Ç–∞–Ω —Å–≤–µ—Ç, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–≥—Ä–µ–µ—Ç —Ç–µ–±—è –≤ –ª—é–±—É—é –Ω–æ—á—å. ‚ú® –¢–≤–æ—è –∑–∞–¥–∞—á–∞ ‚Äî –Ω–∞–π—Ç–∏ –Ω–æ—á–Ω–∏–∫ –≤ —Ñ–æ—Ä–º–µ –∑–≤–µ–∑–¥—ã, —Å–µ—Ä–¥—Ü–∞ –∏–ª–∏ –¥—Ä—É–≥–æ–≥–æ –º–∏–ª–æ–≥–æ —Å–∏–º–≤–æ–ª–∞. üåü –ö–æ–≥–¥–∞ –≤—ã–±–µ—Ä–µ—à—å —Ç—É —Ñ–æ—Ä–º—É, –∫–æ—Ç–æ—Ä–∞—è —Ç–µ–±–µ –ø–æ –¥—É—à–µ, —Å–∫–∞–∂–∏ –µ—ë –Ω–∞–∑–≤–∞–Ω–∏–µ –≤—Å–ª—É—Ö, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –ø–æ–¥–∞—Ä–æ–∫ –∏ –ø–æ–¥—Å–∫–∞–∑–∫—É.",
    "key": "–°–≤–µ—Ç —Å–µ—Ä–¥—Ü–∞",
    "secretMessage": "–¢—ã –æ–∑–∞—Ä—è–µ—à—å –º–æ—é –∂–∏–∑–Ω—å, –¥–∞–∂–µ –∫–æ–≥–¥–∞ –≤—Å—ë –≤–æ–∫—Ä—É–≥ –∫–∞–∂–µ—Ç—Å—è —Ç—ë–º–Ω—ã–º. –°–ø–∞—Å–∏–±–æ, —á—Ç–æ —Ç—ã –µ—Å—Ç—å. üí´‚ú®"
  },
  {
    "title": "–¶–≤–µ—Ç—ã —Å–≤–æ–∏–º–∏ —Ä—É–∫–∞–º–∏",
    "description": "–¢–µ–ø–µ—Ä—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º—Å—è –Ω–∞ –ø—Ä–æ–≥—É–ª–∫—É –ø–æ –ø–∞—Ä–∫—É –∏–ª–∏ –Ω–∞–±–µ—Ä–µ–∂–Ω–æ–π. üå≥ –ù–∞–π–¥–∏ –Ω–µ–º–Ω–æ–≥–æ –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏—è –∏ —Å–æ–±–µ—Ä–∏ –º–∏–Ω–∏-–±—É–∫–µ—Ç –∏–∑ —Ç–æ–≥–æ, —á—Ç–æ —Ç–µ–±–µ –ø–æ–ø–∞–¥—ë—Ç—Å—è: –ª–∏—Å—Ç—å—è, –≤–µ—Ç–æ—á–∫–∏, —Ü–≤–µ—Ç—ã. üå∏ –¢–≤–æ—è —É–Ω–∏–∫–∞–ª—å–Ω–∞—è –∫–æ–º–ø–æ–∑–∏—Ü–∏—è ‚Äî —ç—Ç–æ –∫–ª—é—á. –°–¥–µ–ª–∞–π –µ—ë —Å –ª—é–±–æ–≤—å—é, –∏ –ø–æ–¥–∞—Ä–æ–∫ —Å—Ç–∞–Ω–µ—Ç —Ç–≤–æ–∏–º. ‚ù§Ô∏è",
    "key": "–ü—Ä–∏—Ä–æ–¥–Ω–∞—è –º–∞–≥–∏—è",
    "secretMessage": "–ö–æ–≥–¥–∞ —Ç—ã —Ä—è–¥–æ–º, –ø—Ä–∏—Ä–æ–¥–∞ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –µ—â—ë –ø—Ä–µ–∫—Ä–∞—Å–Ω–µ–µ. –¢–≤–æ—è –º–∞–≥–∏—è –±–µ—Å–∫–æ–Ω–µ—á–Ω–∞. üå∫‚ú®"
  },
  {
    "title": "–î—Ä–∏—Ñ—Ç –º–µ—á—Ç—ã",
    "description": "–í—Ä–µ–º—è –Ω–µ–º–Ω–æ–≥–æ –ø–æ–≤–µ—Å–µ–ª–∏—Ç—å—Å—è! üéâ –°–ª–µ–¥—É—é—â–∞—è —Ç–æ—á–∫–∞ ‚Äî –æ—Ç–∫—Ä—ã—Ç–∞—è –ø–ª–æ—â–∞–¥–∫–∞, –≥–¥–µ —Ç—ã —Å–º–æ–∂–µ—à—å —É—Å—Ç—Ä–æ–∏—Ç—å —Å–≤–æ–π –ø–µ—Ä–≤—ã–π –¥—Ä–∏—Ñ—Ç. üöóüí® –ù–µ –ø–µ—Ä–µ–∂–∏–≤–∞–π, –º—ã –Ω–∞—á–Ω—ë–º —Å —á–µ–≥–æ-—Ç–æ –º–∞–ª–µ–Ω—å–∫–æ–≥–æ: –ø–æ–ø—Ä–æ–±—É–π —É–≥–∞–¥–∞—Ç—å, —á—Ç–æ —Ç–∞–∫–æ–µ '–¥—Ä–∏—Ñ—Ç –º–µ—á—Ç—ã'. –ù–∞–π–¥–∏ –º–∞—à–∏–Ω—É, –∫–æ—Ç–æ—Ä–∞—è –≥–æ—Ç–æ–≤–∞ –≥–æ–Ω—è—Ç—å, –∏ –ø—É—Å—Ç—å –Ω–∞—á–Ω—ë—Ç—Å—è —à–æ—É! üèÅ –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è ‚Äî –∫–ª—é—á —É —Ç–µ–±—è.",
    "key": "–î—Ä–∏—Ñ—Ç-—à–æ—É",
    "secretMessage": "–¢—ã –∑–∞—Å—Ç–∞–≤–ª—è–µ—à—å –º–æ—ë —Å–µ—Ä–¥—Ü–µ —Ä–∞–∑–≥–æ–Ω—è—Ç—å—Å—è, –∫–∞–∫ —Å–∞–º–∞—è –±—ã—Å—Ç—Ä–∞—è –º–∞—à–∏–Ω–∫–∞. –û–±–æ–∂–∞—é —Ç–µ–±—è! üíûüí®"
  },
  {
    "title": "–¢–æ—Ä—Ç–∏–∫-—Å—é—Ä–ø—Ä–∏–∑",
    "description": "–í —Ö–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫–µ —Ç–µ–±—è –∂–¥—ë—Ç —Å–ª–∞–¥–∫–∏–π —Å—é—Ä–ø—Ä–∏–∑. üéÇ –ù–∞–π–¥–∏ –∫–æ—Ä–æ–±–∫—É —Å —Ç–æ—Ä—Ç–∏–∫–æ–º, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–π –µ—Å—Ç—å –∫–æ–µ-—á—Ç–æ –æ—Å–æ–±–µ–Ω–Ω–æ–µ ‚Äî –Ω–∞—à–∞ –¥–∞—Ç–∞. üóìÔ∏è –ß—Ç–æ–±—ã –æ—Ç–∫—Ä—ã—Ç—å –∫–æ—Ä–æ–±–∫—É, –≤—Å–ø–æ–º–Ω–∏ –¥–∞—Ç—É –Ω–∞—à–µ–π –≥–æ–¥–æ–≤—â–∏–Ω—ã –∏ —Å–∫–∞–∂–∏ –µ—ë –≤—Å–ª—É—Ö. –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ —Å—é—Ä–ø—Ä–∏–∑ —Å—Ç–∞–Ω–µ—Ç —Ç–≤–æ–∏–º!",
    "key": "–¢–æ—Ä—Ç–∏–∫ –ª—é–±–≤–∏",
    "secretMessage": "–ö–∞–∂–¥–∞—è –º–∏–Ω—É—Ç–∞ —Å —Ç–æ–±–æ–π ‚Äî —ç—Ç–æ –ø—Ä–∞–∑–¥–Ω–∏–∫. –° —Ç–æ–±–æ–π —è –≤—Å–µ–≥–¥–∞ —Å—á–∞—Å—Ç–ª–∏–≤! ü•∞üéâ"
  },
  {
    "title": "–ú–∞–≥–∏—è —á–∞—è",
    "description": "–¢–µ–ø–µ—Ä—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º—Å—è –≤ —É—é—Ç–Ω—ã–π —á–∞–π–Ω—ã–π –º–∞–≥–∞–∑–∏–Ω. üçµ –ù–∞–π–¥–∏ —Ç–∞–º —á–∞–π, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–¥—Ö–æ–¥–∏—Ç –∏–º–µ–Ω–Ω–æ —Ç–µ–±–µ. –ü–æ–ø—Ä–æ–±—É–π —É–≥–∞–¥–∞—Ç—å, –∫–∞–∫–æ–π –∞—Ä–æ–º–∞—Ç –±–ª–∏–∂–µ —Ç–≤–æ–µ–º—É —Å–µ—Ä–¥—Ü—É. ‚ù§Ô∏è –ö–æ–≥–¥–∞ –≤—ã–±–µ—Ä–µ—à—å ‚Äî —ç—Ç–æ —Å—Ç–∞–Ω–µ—Ç —Ç–≤–æ–∏–º –∫–ª—é—á–æ–º –∫ –Ω–∞–≥—Ä–∞–¥–µ.",
    "key": "–ß–∞–π –ª—é–±–≤–∏",
    "secretMessage": "–° —Ç–æ–±–æ–π –¥–∞–∂–µ —Å–∞–º—ã–µ –ø—Ä–æ—Å—Ç—ã–µ –º–æ–º–µ–Ω—Ç—ã —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è —Ç–µ–ø–ª–µ–µ. –°–ø–∞—Å–∏–±–æ –∑–∞ —ç—Ç–æ! üíïüçÉ"
  },
  {
    "title": "–†–æ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π —Ñ–∏–Ω–∞–ª",
    "description": "–ó–∞–∫–∞–Ω—á–∏–≤–∞–µ–º –¥–µ–Ω—å —É–∂–∏–Ω–æ–º –≤ –Ω–∞—à–µ–º –ª—é–±–∏–º–æ–º –∫–∞—Ñ–µ. üç∑ –ó–¥–µ—Å—å –º—ã —Å–¥–µ–ª–∞–µ–º —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —à—Ç—Ä–∏—Ö. –ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π –ø–æ–¥–∞—Ä–æ–∫, –≤—Å–ø–æ–º–Ω–∏, –∫–∞–∫–æ–µ –Ω–∞—à–µ –ø–µ—Ä–≤–æ–µ –±–ª—é–¥–æ –∏–ª–∏ –Ω–∞–ø–∏—Ç–æ–∫ —Å—Ç–∞–ª–æ –æ—Å–æ–±–µ–Ω–Ω—ã–º. ü•Ç –ò–ª–∏ –≤—ã–±–µ—Ä–∏ —á—Ç–æ-—Ç–æ –Ω–æ–≤–æ–µ ‚Äî –ø—É—Å—Ç—å –æ–Ω–æ —Å—Ç–∞–Ω–µ—Ç —Å–∏–º–≤–æ–ª–æ–º –Ω–∞—à–µ–≥–æ –Ω–æ–≤–æ–≥–æ –≥–æ–¥–∞ –≤–º–µ—Å—Ç–µ.",
    "key": "–†–æ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –≤–∫—É—Å",
    "secretMessage": "–¢—ã –¥–µ–ª–∞–µ—à—å –∫–∞–∂–¥—ã–π –º–æ–º–µ–Ω—Ç –æ—Å–æ–±–µ–Ω–Ω—ã–º. –Ø –ª—é–±–ª—é —Ç–µ–±—è –±–æ–ª—å—à–µ, —á–µ–º —Å–ª–æ–≤–∞ –º–æ–≥—É—Ç –≤—ã—Ä–∞–∑–∏—Ç—å. üíûüç∑"
  },
  {
    "title": "–°–ø–∞-–ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞",
    "description": "–§–∏–Ω–∞–ª—å–Ω–∞—è —Ç–æ—á–∫–∞ ‚Äî —ç—Ç–æ –º–µ—Å—Ç–æ, –≥–¥–µ —Ç—ã —Å–º–æ–∂–µ—à—å —Ä–∞—Å—Å–ª–∞–±–∏—Ç—å—Å—è. üíÜ‚Äç‚ôÄÔ∏è –û—Ç–≤–µ—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å: —á—Ç–æ –¥–ª—è —Ç–µ–±—è –Ω–∞—Å—Ç–æ—è—â–µ–µ —Å—á–∞—Å—Ç—å–µ? (–ü–æ–¥—Å–∫–∞–∑–∫–∞: –≤ —ç—Ç–æ–º —Å–ª–æ–≤–µ —Å–ø—Ä—è—Ç–∞–Ω—ã –ª—é–±–æ–≤—å –∏ –Ω–µ–º–Ω–æ–≥–æ –∑–∞–±–æ—Ç—ã). –ö–æ–≥–¥–∞ –æ—Ç–≤–µ—Ç–∏—à—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –ø–æ–¥–∞—Ä–æ–∫ —Ç–≤–æ–π. üéÅ",
    "key": "–ú–∞—Å—Å–∞–∂–Ω—ã–π –æ—Ç–¥—ã—Ö",
    "secretMessage": "–ö–∞–∂–¥–æ–µ —Ç–≤–æ—ë —Å—á–∞—Å—Ç–ª–∏–≤–æ–µ –º–≥–Ω–æ–≤–µ–Ω–∏–µ –¥–µ–ª–∞–µ—Ç –º–µ–Ω—è —Å—á–∞—Å—Ç–ª–∏–≤–µ–µ. –õ—é–±–ª—é —Ç–µ–±—è! üíñüå∫"
  }
];

  const currentTask = tasks[currentTaskIndex];

  const handleCheckKey = () => {
    const reversedKey = currentTask.key.split("").reverse().join("");

    if (inputValue.trim() === reversedKey) {
      // –ï—Å–ª–∏ –∫–ª—é—á –∑–∞–¥–æ–º –Ω–∞–ø–µ—Ä—ë–¥, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–µ–∫—Ä–µ—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
      setSecretMessage(currentTask.secretMessage);
    } else if (inputValue.trim() === currentTask.key) {
      // –£—Å–ø–µ—Ö: –≤–∫–ª—é—á–∞–µ–º —Å–≤–µ—á–µ–Ω–∏–µ —ç–∫—Ä–∞–Ω–∞
      document.body.style.boxShadow =
        "0 0 40px 20px #ff91a4, inset 0 0 40px 20px #ff6f61";

      setTimeout(() => {
        document.body.style.boxShadow = ""; // –£–±–∏—Ä–∞–µ–º —Å–≤–µ—á–µ–Ω–∏–µ
        setInputValue(""); // –û—á–∏—â–∞–µ–º –ø–æ–ª–µ
        setSecretMessage(""); // –£–±–∏—Ä–∞–µ–º —Å–µ–∫—Ä–µ—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
        setShowInput(false); // –ü–æ–ª–µ –≤–≤–æ–¥–∞ —Å–∫—Ä—ã–≤–∞–µ–º, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É
        if (currentTaskIndex < tasks.length - 1) {
          setCurrentTaskIndex(currentTaskIndex + 1); // –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –∑–∞–¥–∞–Ω–∏—é
        } else {
          setIsFinalSlide(true); // –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —ç–∫—Ä–∞–Ω
        }
      }, 1500);
    } else {
      // –û—à–∏–±–∫–∞: —Ç—Ä—è—Å—ë–º –∫–Ω–æ–ø–∫—É
      setIsError(true); // –í–∫–ª—é—á–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ—à–∏–±–∫–∏
      setTimeout(() => {
        setIsError(false); // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ—à–∏–±–∫–∏ —á–µ—Ä–µ–∑ 1 —Å–µ–∫—É–Ω–¥—É
      }, 1000);
    }
  };

  useEffect(() => {
    if (showInput && inputRef.current) {
      inputRef.current.focus(); // –§–æ–∫—É—Å –Ω–∞ –ø–æ–ª–µ –≤–≤–æ–¥–∞
    }
  }, [showInput]);

  if (isIntroSlide) {
    return (
      <motion.div
        initial={{ opacity: 0, y: -50 }}
        animate={{ opacity: 1, y: 0 }}
        exit={{ opacity: 0 }}
        style={{
          padding: "20px",
          textAlign: "center",
          maxWidth: "90%",
          margin: "0 auto",
        }}
      >
        <h1 style={{ fontSize: "24px", marginBottom: "10px" }}>–¢—ã –≥–æ—Ç–æ–≤–∞ –æ—Ç–∫—Ä—ã—Ç—å —Ç–∞–π–Ω—ã —ç—Ç–æ–≥–æ –¥–Ω—è?</h1>
        <p style={{ fontSize: "18px", marginBottom: "20px" }}>
          –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é —Ç–µ–±—è –≤ –Ω–∞—à–µ–º –º–∞–ª–µ–Ω—å–∫–æ–º –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–∏! üåü
          –¢–µ–±—è –∂–¥—É—Ç —É–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è, –∫–∞–∂–¥–æ–µ –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö –Ω–∞–ø–æ–ª–Ω–µ–Ω–æ —Ç–µ–ø–ª–æ–º –∏ –∑–∞–±–æ—Ç–æ–π. üß© –í –∫–∞–∂–¥–æ–º –∑–∞–¥–∞–Ω–∏–∏ —Å–ø—Ä—è—Ç–∞–Ω–∞ –ø–æ–¥—Å–∫–∞–∑–∫–∞, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–º–æ–∂–µ—Ç –Ω–∞–π—Ç–∏ –∫–ª—é—á –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —à–∞–≥—É. üîë
          –í–≤–æ–¥–∏ –∫–ª—é—á –≤ –ø–æ–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏, —á—Ç–æ–±—ã –ø—Ä–æ–¥–≤–∏–≥–∞—Ç—å—Å—è –¥–∞–ª—å—à–µ. –ï—Å–ª–∏ –≤—Å—ë –≤–µ—Ä–Ω–æ, –≤–ø–µ—Ä–µ–¥–∏ —Ç–µ–±—è –∂–¥—ë—Ç –µ—â—ë –±–æ–ª—å—à–µ —Å—é—Ä–ø—Ä–∏–∑–æ–≤ –∏ –ø–æ–¥–∞—Ä–∫–æ–≤! üéÅ
          –ì–æ—Ç–æ–≤–∞ –Ω–∞—á–∞—Ç—å –Ω–∞—à–µ –≤–æ–ª—à–µ–±–Ω–æ–µ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ? üíñ
        </p>
        <button
          onClick={() => setIsIntroSlide(false)}
          style={{
            padding: "10px 20px",
            fontSize: "16px",
            borderRadius: "5px",
            backgroundColor: "#ff6f61",
            color: "#fff",
            border: "none",
            cursor: "pointer",
          }}
        >
          –Ø –≥–æ—Ç–æ–≤–∞!
        </button>
      </motion.div>
    );
  }

  if (isFinalSlide) {
    return (
      <motion.div
        initial={{ opacity: 0, scale: 0.9 }}
        animate={{ opacity: 1, scale: 1 }}
        exit={{ opacity: 0 }}
        style={{
          padding: "20px",
          textAlign: "center",
          maxWidth: "90%",
          margin: "0 auto",
        }}
      >
        <h1 style={{ fontSize: "24px", marginBottom: "10px" }}>–°–ø–∞—Å–∏–±–æ –∑–∞ —Ç–æ, —á—Ç–æ –ø—Ä–æ—à–ª–∞ —ç—Ç–æ—Ç –ø—É—Ç—å —Å–æ –º–Ω–æ–π! üíñ</h1>
        <p style={{ fontSize: "18px" }}>
          –¢—ã —Å–¥–µ–ª–∞–ª–∞ —ç—Ç–æ! –í—Å–µ –∑–∞–¥–∞–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω—ã, –∏ –∫–∞–∂–¥–æ–µ –∏–∑ –Ω–∏—Ö –Ω–∞–ø–æ–ª–Ω–∏–ª–æ –Ω–∞—à –¥–µ–Ω—å –æ—Å–æ–±–µ–Ω–Ω—ã–º —Å–º—ã—Å–ª–æ–º. üåü
          –°–ø–∞—Å–∏–±–æ –∑–∞ —Ç–≤–æ—é —É–ª—ã–±–∫—É, —Å–º–µ—Ö –∏ –∏—Å–∫–æ—Ä–∫–∏ –≤ –≥–ª–∞–∑–∞—Ö ‚Äî –æ–Ω–∏ –¥–µ–ª–∞—é—Ç –º–æ—é –∂–∏–∑–Ω—å –Ω–µ–≤–µ—Ä–æ—è—Ç–Ω–æ —Å—á–∞—Å—Ç–ª–∏–≤–æ–π. –ö–∞–∂–¥—ã–π –º–æ–º–µ–Ω—Ç —Å —Ç–æ–±–æ–π ‚Äî —ç—Ç–æ –ø–æ–¥–∞—Ä–æ–∫, –∏ —è –±–ª–∞–≥–æ–¥–∞—Ä–µ–Ω –∑–∞ –Ω–∞—à—É –ª—é–±–æ–≤—å. ‚ù§Ô∏è
          –¢—ã ‚Äî —Å–∞–º–æ–µ –ø—Ä–µ–∫—Ä–∞—Å–Ω–æ–µ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–µ –≤ –º–æ–µ–π –∂–∏–∑–Ω–∏, –∏ —ç—Ç–æ —Ç–æ–ª—å–∫–æ –Ω–∞—á–∞–ª–æ. –õ—é–±–ª—é —Ç–µ–±—è –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ. üíû
        </p>
      </motion.div>
    );
  }

  return (
    <motion.div
      initial={{ opacity: 0, x: -50 }}
      animate={{ opacity: 1, x: 0 }}
      exit={{ opacity: 0 }}
      style={{
        padding: "20px",
        textAlign: "center",
        maxWidth: "50%",
        minWidth: "500px",
        margin: "0 auto",
      }}
    >
      {/* –ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è */}
      <motion.h1
        key={currentTask.title}
        initial={{ opacity: 0, y: -20 }}
        animate={{ opacity: 1, y: 0 }}
        transition={{ duration: 0.5 }}
        style={{ fontSize: "24px", marginBottom: "10px" }}
      >
        {currentTask.title}
      </motion.h1>

      {/* –û–ø–∏—Å–∞–Ω–∏–µ –∏–ª–∏ —Å–µ–∫—Ä–µ—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ */}
      <motion.p
        key={secretMessage || currentTask.description}
        initial={{ opacity: 0 }}
        animate={{ opacity: 1 }}
        transition={{ duration: 0.5 }}
        style={{ fontSize: "18px", marginBottom: "20px" }}
      >
        {secretMessage || currentTask.description}
      </motion.p>

      {/* –ü–æ–ª–µ –≤–≤–æ–¥–∞ */}
      <AnimatePresence>
        {showInput || secretMessage ? (
          <motion.div
            initial={{ opacity: 0, y: 10 }}
            animate={{ opacity: 1, y: 0 }}
            exit={{ opacity: 0 }}
            transition={{ duration: 0.5 }}
            style={{ marginTop: "20px" }}
          >
            <input
              ref={inputRef}
              type="text"
              value={inputValue}
              onChange={(e) => setInputValue(e.target.value)}
              placeholder="–í–≤–µ–¥–∏ –∫–ª—é—á"
              style={{
                padding: "10px",
                fontSize: "16px",
                borderRadius: "5px",
                border: "2px solid #ccc",
                width: "200px",
                marginRight: "10px",
                transition: "border-color 0.3s",
              }}
            />
            <button
              onClick={handleCheckKey}
              className={`task-button ${isError ? "error" : ""}`}
              style={{
                padding: "10px 20px",
                fontSize: "16px",
                borderRadius: "5px",
                backgroundColor: isError ? "#ff6f6f" : "#ff6f61",
                color: "#fff",
                border: "none",
                cursor: "pointer",
                animation: isError ? "shake 0.5s" : "none",
              }}
            >
              –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–ª—é—á
            </button>
          </motion.div>
        ) : (
          <motion.button
            onClick={() => setShowInput(true)}
            className={`task-button ${isError ? "error" : ""}`}
            initial={{ opacity: 0, y: 10 }}
            animate={{ opacity: 1, y: 0 }}
            exit={{ opacity: 0 }}
            style={{
              marginTop: "20px",
              padding: "10px 20px",
              fontSize: "16px",
              borderRadius: "5px",
              backgroundColor: isError ? "#ff6f6f" : "#ff6f61",
              color: "#fff",
              border: "none",
              cursor: "pointer",
            }}
          >
            –Ø –≤—ã–ø–æ–ª–Ω–∏–ª–∞ –∑–∞–¥–∞–Ω–∏–µ
          </motion.button>
        )}
      </AnimatePresence>
    </motion.div>
  );
}

export default QuestStep;